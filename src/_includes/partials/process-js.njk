{# Don't load this async or defer because it needs to come in prior to the actual data it manipulates #}
{%- if d3 -%}
    <script src="/assets/js/d3.min.js" defer></script>
{%- endif -%}

<script type="module" src="/assets/js/script.js" async></script>

{%- if addJS or home -%}
    {%- set js -%}
        {%- if addJS -%}
            {%- include "../js/" + page.fileSlug + ".js" -%}
        {%- endif -%}
        {%- if home -%}
            {%- include "../js/homepage.js" -%}
        {%- endif -%}
    {%- endset -%}

    {%- if site.environment == "production" -%}
        <script type="module">
            {{ js | jsmin | safe }}
        </script>
    {%- else -%}
        <script type="module">
            {{ js | safe }}
        </script>
    {%- endif -%}

{%- endif -%}

{%- if plvylist -%}
    <script src="/assets/js/plvylist-component.js" async></script>
{%- endif -%}

{%- if lightbox -%}
    <script src="/assets/js/zooming.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const zooming = new Zooming({
                bgColor: 'rgb(0, 0, 0)',
                bgOpacity: .5,
                customSize: '135%'
            })

            zooming.listen('.img-zoomable')
        })
    </script>
{%- endif -%}